...
else if (k >= num_lessoreq) {
    return kth(above, k - num_less); // Change made here
}
...
