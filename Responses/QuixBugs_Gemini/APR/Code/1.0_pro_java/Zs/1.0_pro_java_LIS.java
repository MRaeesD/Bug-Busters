longest = length + 1;
ends.put(length, i);  // Change here
